# yolo
## 프로젝트 yolo 테스트
d:\ai_exam\yolo5_test 생성

## <가상환경 생성>
* anaconda powershell prompt 에서
```
conda create -n p312_yolov5 python=3.12
conda env list
```
![가상환경]()

* vscode로 프로젝트 열기

* yolov5 다운
https://github.com/ultralytics/yolov5?tab=readme-ov-file

* D:\dev\github\AI-DX-education\ai_exam\yolov5_test 에 다운한 파일 넣기


## 라이브러리 설치(한번에)
```
pip install -r requirements.txt
```

## 객체 인식 잘되는지 확인
* 객체에 대한 클래스 정의된 부분 (PyYaml)
D:\dev\github\AI-DX-education\ai_exam\yolov5_test\data\coco.yaml
->  

* 동작시키는 방법
```
python detect.py --weights yolov5s.pt --source 0
```
yolov5 small 로 동작
source 0 : 카메라 0번 가공시켜서 detect
-> 카메라 가동됨
![카메라]()

* 동작시키는 방법 (핸드폰만 인식하게 하고 싶다면)
```
python detect.py --weights yolov5s.pt --source 0 --classes 67
```

![카메라_핸드폰]()

* 인터넷에 있는 이미지를 학습
```
python detect.py --weights yolov5s.pt --source "url 주소"
```
ex) 뉴진스 사진 주소를 넣음
python detect.py --weights yolov5s.pt --source "https://img9.yna.co.kr/etc/inner/KR/2024/04/27/AKR20240427027100005_01_i_P2.jpg"

![이미지]()
![이미지결과]()

## 설치된 pip 확인
```
pip list
```
![piplist]()

## 경로 설정
D:\dev\github\AI-DX-education\ai_exam\yolov5_program 으로 변경하기
가상환경은 동일


## test.py
```
# 라이브러리 설치
import torch

# 모델
model = torch.hub.load('ultralytics/yolov5', 'yolov5s')
```
-> 이 파일을 가동시키면

![가상환경가동]()


## 사진으로 검증
* 사진 정보 보기
```
# 라이브러리 설치
import torch

# 모델
model = torch.hub.load('ultralytics/yolov5', 'yolov5s')

# 이미지 검증 (predict)
img = "https://cdn.mediatoday.co.kr/news/photo/202311/313885_438531_4716.jpg"

# 검증
results = model(img)

results.print()  
```
![사진검증]()

* 사진으로 보기
```
# 라이브러리 설치
import torch

# 모델
model = torch.hub.load('ultralytics/yolov5', 'yolov5s')

# 이미지 검증 (predict)
img = "https://cdn.mediatoday.co.kr/news/photo/202311/313885_438531_4716.jpg"

# 검증
results = model(img)

# 출력
results.print()  

# 프로그램에서 사용할 수 있도록 정보 받기 (화면에 이미지 출력)
results.show()
```
![사진출력]()


* 데이터 구조 형태로 보기
```
# 라이브러리 설치
import torch

# 모델
model = torch.hub.load('ultralytics/yolov5', 'yolov5s')

# 이미지 검증 (predict)
img = "https://cdn.mediatoday.co.kr/news/photo/202311/313885_438531_4716.jpg"

# 검증
results = model(img)

# 출력
results.print()  

# 프로그램에서 사용할 수 있도록 정보 받기 (화면에 이미지 출력)
results.show()

# 데이터 구조 형태로 보기
print(results.pandas().xyxy[0])
```

![데이터구조형태]()

* 모든 사람 detect 파일을 저장 + 사람마다 자른 사진 저장
```
# savedata 폴더에 저장
results.save()

# crop
results.crop()
```
-> 이 코드를 추가하면 된다.

![사진저장]()
![사람마다]()

## 미세 조정 처리하는 방법
### 파라미터 제어
* 인식률
```
model.conf = 0.6
```
-> 이 코드를 추가하면 60% 이상의 확률로 검출된 객체만 출력한다.

* 모델과 모델의 겹치는 % 계산
```
model.iou = 0.45
```
-> 45% 이상의 IOU를 가진 객체만 출력


## 커스텀 모델 구현
### 1. 원본 데이터 -> 데이터셋 생성 (yolov5용 데이터셋 별도로 존재)
강아지, 고양이 3개 데이터만 데이터셋 yolo 만들어보기

* D:\dev\github\AI-DX-education\ai_exam\yolov5_program\dataset 폴더 생성

* google -> pypi labelimg
```
pip install labelImg
```

* 터미널에서 LabelImg 실행
```
LabelImg
```

### 2. 학습
* google -> roboflow 데이터셋
https://roboflow.com/




### 3. 결과를 프로그램에 사용





![]()
![]()
![]()
![]()
![]()
![]()
![]()
![]()
![]()
![]()
