# yolov5 학습
* 커스텀 모델 (custom model)
=> 데이터 수집 -> 데이터분류 -> dataset -> 전처리 -> 학습 -> pre-trained
=> 서비스 구축

* pre-trained 모델을 사용한다.
=> pre-trained 서비스 구축
- 인공지능을 구현하는 부분보다는 sota(status of the art) 서비스 구축


# 커스텀 모델 구축
* 알파벳 학습
engsign.zip
- 구글드라이브에 압축을 풀어서 업로드 (나는 여기서 이거 선택!)
- 압축파일을 올려서 압축을 해제 

* 코랩 + 구글드라이브

* 노트명 : yolov5_sign

## 학습 결과
```
# 학습진행
! python train.py --img 415 --batch 16 --epochs 50 --data /content/drive/MyDrive/AI-DX-education/datasets/data.yaml --cfg ./models/yolov5s.yaml --weights yolov5s.pt --name sign_yolov5s_results
```
![학습결과]()

-> 결과를 보면 i가 학습률이 낮은 것을 알 수 있다. 


### last.pt, best.pt
/content/drive/MyDrive/AI-DX-education/datasets/sign/sign_yolov5s_results/weights

이 경로에 있는 last.pt, best.pt 중 어떤 것을 써야할까? 정답은 둘 다 써야한다.

지금처럼 일부 성능이 안좋으면 학습을 더 시켜야하고 성능을 더 끌어오르는지 봐야한다.

이 경우는 이미지를 증가시킬때 image generator를 쓰면 안된다. 왜냐하면 이 이미지는 정면의 수화를 인식하는건데, 수화의 형태가 정해져있기 때문에 수화가 돌아가거나 변하면 다른 언어로 인식할 수 있기 때문이다. 


### confusion nmatrix
confusion matrix에서 대각선이 1이 나오면 100% 정확한것이다. 

![confusionmatrix]()

-> 내 confusion matrix를 보면 거의 못맞춘다는 것을 알 수 있다.

### F1 curve
뚝뚝 떨어지는 그래프는 검출이 안된다는 것이다.

### labels
데이터는 고르게 들어와서 데이터의 문제는 아니지만, 수화 자체가 쉽지 않았기 때문에 인식을 못한것으로 보임

### P curve, PR curve, R curve
파란색 그래프에 밀접하게 학습이 안되었다.

![P_curve]()
![PR_curve]()
![R_curve]()

### results
![results]()

### 실제 인식한 이미지
![train_batch0]()
![train_batch1]()
![train_batch2]()

### result.csv 
평가에 대한 보고서

## 내 컴퓨터 파일
D:\dev\github\AI-DX-education\ai_exam\yolov5_test\runs\
이 경로에 
train 폴더 생성 -> colab에 sign_yolov5s_results 폴더에 있는 모든 파일을 train폴더에 옮기기


## custom model 동작
* vscode 에서
D:\dev\github\AI-DX-education\ai_exam\yolov5_test 
폴더 열기

* 가상환경 : p312_yolov5

## h 영어 수화 손동작을 
* 터미널
```
python detect.py --weights ./runs/train/sign_yolov5s_results/weights/best.pt --conf 0.5 --source https://www.youtube.com/watch?v=1rD4w_QvtiE&t=1s 
```









![]()
![]()
![]()
![]()
![]()
![]()
![]()
![]()
![]()
![]()
![]()
