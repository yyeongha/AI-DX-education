# Face Recognition 

## 1. 경로
D:\dev\github\AI-DX-education\ai_exam\aiwebcam\face_dataset\faiss_dataset.py 생성

## 2. python interpreter 
* 가상환경 p312_aiwebcam으로 바꾸기

* 라이브러리 설치
```
pip install face_recognition
pip install faiss-cpu
pip install faiss-gpu => CUDA, CuDNN이 서치되어있는경우
```

## 3. faiss_dataset.py 작성
```
# 라이브러리 불러오기
import os
import numpy as np
from PIL import Image
import faiss
import face_recognition

# 디렉토리 처리하는 함수
def createFolder(directory):
    try:
        if not os.path.exists(directory):
            os.makedirs(directory)
    except OSError:
        print("에러 : 디렉토리 생성에러. " + directory)

# 디렉토리에 있는 파일을 불러오는 함수
def read_file(path):
    img_path = []
    # 데이터 가져오기
    for (paths, subdir, files) in os.walk(path):
        print('paths:', paths)
        print('subdir:', subdir)
        print('files:', files)
        
        # 파일명을 변수에 넣기
        for name in files:
            img_path.append(os.path.join(paths, name))
    return img_path

# 학습데이터 전처리
train_images = read_file('./org_data')

print(train_images)
```

![실행]()

* 위 코드에서 학습데이터 전처리 부분을 이렇게 바꾸면
```
# 학습데이터 전처리
train_images = read_file('./org_data')

# print(train_images)
print('-'*50)
print('학습할 데이터 파일 경로')
print('-'*50)
for data in train_images:
    print(data)
print('-'*50)
```
![실행2]()
![실행3]()

* 불러온 이미지에서 얼굴만 추출 

## 3. 작업순서
* 사진 10장 이내로 정확하게 예측
* 데이터전처리 -> 데이터 훈련(train) : 벡터DB -> 예측(predict)
1. 데이터 전처리 : faiss_dataset.py -> dataset
2. 훈련 벡터 DB : faiss_dataset.py -> faiss_idx(벡터)
=> train/faiss.idx (벡터 db)
3. 벡터 DB로 예측 : faiss_predict.py -> django에 서비스에서 사용

### 0) 데이터 생성 (create_dataset.py)


### 1) 데이터 전처리 (faiss_dataset.py)

### 2) 훈련 벡터 DB



## faiss_predict.py
result = face_predict(예측하고 싶은 opencv 들어온 값)
총 3개이상 예측값이 일치하면 값을 result로 치고

보통 검출할때 평균적으로 10개를 넣고 5개를 예측함
그래야 거의다 예측함

유사도는 있는거에서 유사도를 찾기 때문에 10개정도를 넣는것이 가장 정확할 가능성이 높다.


